<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimisation result for two aligned molecules — OptimisationResult • symbo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimisation result for two aligned molecules — OptimisationResult"><meta name="description" content="OptimisationResult is an S7  object that stores the outcome of
a geometric optimisation used to align two structures::Molecule3D
objects. It records the optimised geometries of each molecule, the
optimisation objective, key geometric parameters (angles, slides and
axes) and bookkeeping information returned by the optimiser."><meta property="og:description" content="OptimisationResult is an S7  object that stores the outcome of
a geometric optimisation used to align two structures::Molecule3D
objects. It records the optimised geometries of each molecule, the
optimisation objective, key geometric parameters (angles, slides and
axes) and bookkeeping information returned by the optimiser."><meta property="og:image" content="https://selkamand.github.io/symbo/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">symbo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/manual.html">Manual</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/selkamand/symbo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Optimisation result for two aligned molecules</h1>
      <small class="dont-index">Source: <a href="https://github.com/selkamand/symbo/blob/main/R/classes.R" class="external-link"><code>R/classes.R</code></a></small>
      <div class="d-none name"><code>OptimisationResult.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>OptimisationResult</code> is an S7  object that stores the outcome of
a geometric optimisation used to align two <code><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">structures::Molecule3D</a></code>
objects. It records the optimised geometries of each molecule, the
optimisation objective, key geometric parameters (angles, slides and
axes) and bookkeeping information returned by the optimiser.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">OptimisationResult</span><span class="op">(</span></span>
<span>  shapeclass <span class="op">=</span> <span class="st">"NotSpecified"</span>,</span>
<span>  mol1 <span class="op">=</span> <span class="fu">structures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">Molecule3D</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mol2 <span class="op">=</span> <span class="fu">structures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">Molecule3D</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  min_sum_of_squared_distance <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>  angle_between_dummy_binding_vectors <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>  mol1_phi <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>  mol2_phi <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>  mol1_slide <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>  mol2_slide <span class="op">=</span> <span class="cn">NaN</span>,</span>
<span>  mol1_axis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span><span class="op">)</span>,</span>
<span>  mol2_axis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span><span class="op">)</span>,</span>
<span>  n_calls_to_fn <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_calls_to_gr <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  convergence <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  hessian <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mol-">mol1<a class="anchor" aria-label="anchor" href="#arg-mol-"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">structures::Molecule3D</a></code> object giving the
optimised coordinates of the first molecule. Defaults to an empty
<code>Molecule3D()</code> instance.</p></dd>


<dt id="arg-mol-">mol2<a class="anchor" aria-label="anchor" href="#arg-mol-"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">structures::Molecule3D</a></code> object giving the
optimised coordinates of the second molecule. Defaults to an empty
<code>Molecule3D()</code> instance.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A new <code>OptimisationResult</code> S7 object with the supplied molecules and
all other fields initialised to their type-appropriate defaults.</p>
    </div>
    <div class="section level2">
    <h2 id="fields">Fields<a class="anchor" aria-label="anchor" href="#fields"></a></h2>



<p>The class has the following properties:</p>
<dl><dt>mol1</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">structures::Molecule3D</a></code> object representing
the first input molecule in its geometrically optimised form (i.e.,
after applying the optimal rotation/translation that minimises
<code>min_sum_of_squared_distance</code>).</p></dd>


<dt>mol2</dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">structures::Molecule3D</a></code> object representing
the second input molecule in its geometrically optimised form.</p></dd>


<dt>min_sum_of_squared_distance</dt>
<dd><p>Numeric scalar giving the
minimised sum of squared distances between the dummy atoms of each
molecule and the opposing binding atom. Formally:
\(d_1^2 + d_2^2\), where \(d_1\) is the distance from the mol1
dummy atom to the mol2 binding atom, and \(d_2\) is the distance
from the mol2 dummy atom to the mol1 binding atom, evaluated at the
optimum.</p></dd>


<dt>angle_between_dummy_binding_vectors</dt>
<dd><p>Numeric scalar (radians)
giving the angle between the vector from mol1 dummy \(\to\) mol1
binding atom and the vector from mol2 dummy \(\to\) mol2 binding
atom, computed for the optimised geometry. For a “perfect” solution
this angle would be \(\pi\) (180 degrees).</p></dd>


<dt>mol1_phi</dt>
<dd><p>Numeric scalar (radians): the optimal rotation angle
applied to <code>mol1</code> about <code>mol1_axis</code> to obtain the geometrically
optimal configuration.</p></dd>


<dt>mol2_phi</dt>
<dd><p>Numeric scalar (radians): the optimal rotation angle
applied to <code>mol2</code> about <code>mol2_axis</code>.</p></dd>


<dt>mol1_slide</dt>
<dd><p>Numeric scalar giving the optimal distance to
translate <code>mol1</code> along <code>mol1_axis</code> (the “slide” along the axis)
in the optimal configuration.</p></dd>


<dt>mol2_slide</dt>
<dd><p>Numeric scalar giving the optimal distance to
translate <code>mol2</code> along <code>mol2_axis</code>.</p></dd>


<dt>mol1_axis</dt>
<dd><p>Numeric length-3 vector describing the Cartesian
direction of the symmetry axis about which <code>mol1</code> was rotated and
along which it was slid during optimisation.</p></dd>


<dt>mol2_axis</dt>
<dd><p>Numeric length-3 vector describing the corresponding
axis for <code>mol2</code>.</p></dd>


<dt>n_calls_to_fn</dt>
<dd><p>Numeric scalar giving the number of calls to
the objective function (<code>fn</code>) made by the optimiser.</p></dd>


<dt>n_calls_to_gr</dt>
<dd><p>Numeric scalar giving the number of calls to
the gradient function (<code>gr</code>) made by the optimiser (where applicable).</p></dd>


<dt>convergence</dt>
<dd><p>Numeric scalar convergence code, typically matching
the codes returned by <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code>. For example:</p><ul><li><p><code>0</code> – successful completion (method-dependent).</p></li>
<li><p><code>1</code> – iteration limit (<code>maxit</code>) reached.</p></li>
<li><p><code>10</code> – degeneracy of the Nelder–Mead simplex.</p></li>
<li><p><code>51</code> – warning from method <code>"L-BFGS-B"</code> (see <code>message</code>).</p></li>
<li><p><code>52</code> – error from method <code>"L-BFGS-B"</code> (see <code>message</code>).</p></li>
</ul><p>See the documentation of the optimisation routine for exact meanings.</p></dd>


<dt>message</dt>
<dd><p>Character scalar giving any additional information
returned by the optimiser (e.g. warnings, diagnostic messages). May be
<code>NA_character_</code> if no message is available.</p></dd>


<dt>hessian</dt>
<dd><p>Numeric object (typically a symmetric matrix) giving an
estimate of the Hessian at the solution, if available. This is usually
the Hessian of the <em>unconstrained</em> problem, even if box constraints are
active. If the optimisation was run without requesting a Hessian, this
property is set to <code>NaN</code>. Assigning <code>NULL</code> to <code>hessian</code> will also store
<code>NaN</code> internally.</p></dd>



</dl></div>
    <div class="section level2">
    <h2 id="typical-usage">Typical usage<a class="anchor" aria-label="anchor" href="#typical-usage"></a></h2>



<p>Instances of <code>OptimisationResult</code> are usually created internally by
higher-level alignment / docking routines, and returned as a structured
record of the optimisation outcome for a given shape class or binding
mode.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># (Pseudo-example; real usage would normally be through an optimiser)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">OptimisationResult</span><span class="op">(</span></span></span>
<span class="r-in"><span>  mol1 <span class="op">=</span> <span class="fu">structures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">Molecule3D</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  mol2 <span class="op">=</span> <span class="fu">structures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/structures/man/Molecule3D.html" class="external-link">Molecule3D</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">@</span><span class="va">min_sum_of_squared_distance</span> <span class="op">&lt;-</span> <span class="fl">0.12</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">@</span><span class="va">n_calls_to_fn</span> <span class="op">&lt;-</span> <span class="fl">35</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimisation Result</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Shape Classes: NotSpecified</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimised Sum of Squared Distance: 0.120000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimised Angle (pi = perfect): NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence: NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sam El-Kamand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

